<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>carsh</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/example.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/header.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/filter.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/main.css') }}">
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="../static/scripts/main.js"></script>

</head>
<body>
<header>
<ul>
    <li>Home</li>
    <li>Discover</li>
    <li>howto</li>
    <li>Search</li>

</ul>

</header>
<div class="container">
    {{ sform.csrf_token }}
    <section id="filter" >
        <div class="filter-column" >
            {{ sform.car_make.label }}
            {{ sform.car_make() }}
        </div>
        <div class="filter-column">
           {{ sform.car_model.label }}
            {{ sform.car_model() }}
        </div>
        <div class="filter-column">
            {{ sform.car_year.label }}
            {{ sform.car_year() }}
        </div>
        <div class="filter-column" >
            {{ sform.search }}
        </div>  
    </section>
    <section id="car-items">
        <div class="car-item">
{#            calculations#}
        </div>
        <div class="car-item"></div>
        <div class="car-item"></div>
    </section>
</div>
<script>
    let modelSelect = document.getElementById('car_model');
    let yearSelect = document.getElementById('car_year');

    let defaultModelOption = document.createElement('option');
    defaultModelOption.value = '';
    defaultModelOption.textContent = 'Select Model';
    modelSelect.appendChild(defaultModelOption);

    let defaultYearOption = document.createElement('option');
    defaultYearOption.value = '';
    defaultYearOption.textContent = 'Select Year';
    yearSelect.appendChild(defaultYearOption);

    document.getElementById('car_make').addEventListener('change', function() {
        console.log('Make selection changed!');
        let make = this.value;
        fetch('/get_models', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: 'make=' + make,
        })
        .then(response => response.json())
        .then(models => {
            let modelSelect = document.getElementById('car_model');
            modelSelect.innerHTML = '';
            let defaultModelOption = document.createElement('option');
            defaultModelOption.value = '';
            defaultModelOption.textContent = 'Select Model';
            modelSelect.appendChild(defaultModelOption);
            models.forEach(model => {
                let option = document.createElement('option');
                option.value = model;
                option.textContent = model;
                modelSelect.appendChild(option);
            });

            let yearSelect = document.getElementById('car_year');
            yearSelect.innerHTML = '';
            let defaultYearOption = document.createElement('option');
            defaultYearOption.value = '';
            defaultYearOption.textContent = 'Select Year';
            yearSelect.appendChild(defaultYearOption);
        });
    });

    document.getElementById('car_model').addEventListener('change', function() {
        let make = document.getElementById('car_make').value;
        let model = this.value;
        fetch('/get_years', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: 'make=' + make + '&model=' + model,
        })
        .then(response => response.json())
        .then(years => {
            let yearSelect = document.getElementById('car_year');
            yearSelect.innerHTML = '';
            let defaultYearOption = document.createElement('option');
            defaultYearOption.value = '';
            defaultYearOption.textContent = 'Select Year';
            yearSelect.appendChild(defaultYearOption);
            years.forEach(year => {
                let option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                yearSelect.appendChild(option);
            });
        });
    });
</script>
{#<script>#}
{#    document.getElementById('car_make').addEventListener('change', function() {#}
{#        let make = this.value;#}
{#        fetch('/get_models', {#}
{#            method: 'POST',#}
{#            headers: {#}
{#                'Content-Type': 'application/x-www-form-urlencoded',#}
{#            },#}
{#            body: 'make=' + make,#}
{#        })#}
{#        .then(response => response.json())#}
{#        .then(models => {#}
{#            let modelSelect = document.getElementById('car_model');#}
{#            modelSelect.innerHTML = '';#}
{#            models.forEach(model => {#}
{#                let option = document.createElement('option');#}
{#                option.value = model;#}
{#                option.textContent = model;#}
{#                modelSelect.appendChild(option);#}
{#            });#}
{#        });#}
{#    });#}
{##}
{#    document.getElementById('car_model').addEventListener('change', function() {#}
{#        let make = document.getElementById('car_make').value;#}
{#        let model = this.value;#}
{#        fetch('/get_years', {#}
{#            method: 'POST',#}
{#            headers: {#}
{#                'Content-Type': 'application/x-www-form-urlencoded',#}
{#            },#}
{#            body: 'make=' + make + '&model=' + model,#}
{#        })#}
{#        .then(response => response.json())#}
{#        .then(years => {#}
{#            let yearSelect = document.getElementById('car_year');#}
{#            yearSelect.innerHTML = '';#}
{#            years.forEach(year => {#}
{#                let option = document.createElement('option');#}
{#                option.value = year;#}
{#                option.textContent = year;#}
{#                yearSelect.appendChild(option);#}
{#            });#}
{#        });#}
{#    });#}
{##}
{#</script>#}
</body>
</html>

